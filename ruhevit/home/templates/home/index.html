{% extends "core/base.html" %}
{% load static %}

{% block title %}Мої запити{% endblock %}

{% block content %}


            <!-- Секція "Ваші запити" -->
            <section class="requests-block">
                <h2 class="requests-text">Ваші запити як ініціатора</h2>
                <div class="requests">
                    {% for req in user_owner_requests %}
                        <article class="request">
                            <div class="request-pic">
                                <div class="request-pic-container">
                                    <img src="{% static 'home/images/icon.svg' %}" alt="Request Icon" class="landing-imageicon2">
                                </div>
                            </div>
                            <div class="request-info">
                                <h3 class="request-title">{{ req.name }}</h3>
                                <p class="progress-status">{{ req.get_status_display }}</p>
                                <div class="request-details">
                                    <div class="deadline-info">
                                        <p class="detail-label">дата публікації</p>
                                        <p class="detail-value">{{ req.created_at|date:"d.m.Y" }}</p>
                                    </div>
                                    <div class="volunteer-info">
                                        <p class="detail-label">виконавець</p>
                                        <p class="detail-value">
                                            {% if req.executor %}
                                                {{ req.executor.get_full_name|default:req.executor.get_username }}
                                            {% else %}
                                                Не визначено
                                            {% endif %}
                                        </p>
                                    </div>
                                </div>
                                
                                <div class="action-buttons">
                                    {% if req.executor.email %}
                                    <button onclick="window.location.href='mailto:{{ req.executor.email }}'" class="action-button contac">Сконтактувати</button>
                                    {% endif %}
                                    <button onclick="window.location.href='{% url 'request_detail' req.id %}'" class="action-button confirm">Детальніше</button>
                                   
                                </div>
                            </div>
                        </article>
                    {% empty %}
                        <p>У вас поки що немає запитів.</p>
                    {% endfor %}
                </div>
            </section>

            <!-- Секція "Ваші запити" -->
            <section class="requests-block">
                <h2 class="requests-text">Ваші запити як виконавця</h2>
                <div class="requests">
                    {% for req in user_exec_requests %}
                        <article class="request">
                            <div class="request-pic">
                                <div class="request-pic-container">
                                    <img src="{% static 'home/images/icon.svg' %}" alt="Request Icon" class="landing-imageicon2">
                                </div>
                            </div>
                            <div class="request-info">
                                <h3 class="request-title">{{ req.name }}</h3>
                                <p class="progress-status">{{ req.get_status_display }}</p>
                                <div class="request-details">
                                    <div class="deadline-info">
                                        <p class="detail-label">дата публікації</p>
                                        <p class="detail-value">{{ req.created_at|date:"d.m.Y" }}</p>
                                    </div>
                                    <div class="volunteer-info">
                                        <p class="detail-label">ініціатор</p>
                                        <p class="detail-value">
                                            {% if req.owner %}
                                                {{ req.owner.get_full_name|default:req.owner.get_username }}
                                            {% else %}
                                                Не визначено
                                            {% endif %}
                                        </p>
                                    </div>
                                </div>
                                <div class="action-buttons">
                                    {% if req.owner.email %}
                                    <button onclick="window.location.href='mailto:{{ req.owner.email }}'" class="action-button contact">Сконтактувати</button>
                                    {% endif %}
                                    <button onclick="window.location.href='{% url 'request_detail' req.id %}'" class="action-button confirm">Детальніше</button>
                                </div>
                            </div>
                        </article>
                    {% empty %}
                        <p>У вас поки що немає запитів.</p>
                    {% endfor %}
                </div>
            </section>

            <!-- Секція "Пропозиції допомоги" -->
            <section class="help-offers">
                <h2 class="section-title">Пропозиції допомоги</h2>
                <div class="filters-and-sorting">
                    <button class="filter-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-filter" viewBox="0 0 16 16">
                            <path d="M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5m-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5"/>
                        </svg>
                        <span class="filter-text">Фільтри</span>
                    </button>
                    <button class="sorting-button">
                        <span class="sort-text">&#8645;Сортування</span>
                    </button>
                </div>
                <div class="offers-container">
                    {% for offer in help_offers %}
                        <article class="offer-card">
                            <div class="offer-image">
                                <img src="{% static 'home/images/Image_icon.svg' %}" alt="Offer Icon" class="offer-icon">
                            </div>
                            <div class="offer-info">
                                <div class="author-info">
                                    {% if offer.owner.profile_picture %}
                                        <img src="{{ offer.owner.profile_picture.url }}" alt="Author" class="request-icon-image" width="60" height="60" />
                                    {% else %}
                                        <img src="{% static 'core/images/blank.png' %}" alt="Author" class="request-icon-image" width="60" height="60" />
                                    {% endif %}
                                    <p class="author-name">{{ offer.owner.get_full_name }}</p>
                                </div>
                                <div class="offer-content">
                                    <h3 class="offer-title">{{ offer.name }}</h3>
                                    <p class="offer-description">{{ offer.description }}</p>
                                </div>
                                <div class="offer-tags">
                                    {# Можна перебрати теги, якщо вони є #}
                                </div>
                                <!-- Динамічне посилання "Детальніше" -->
                                <button onclick="window.location.href='{% url 'request_detail' offer.id %}'" class="details-button">Детальніше</button>
                
                            </div>
                        </article>
                    {% empty %}
                        <p>Наразі немає пропозицій допомоги.</p>
                    {% endfor %}
                </div>
            </section>
        </div>
        <script src="{% static 'home/script.js' %}" defer></script>
    </body>
{% endblock %}