{% extends "core/base.html" %}
{% load static %}

{% block title %}Ругевіт - Реєстрація{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="https://unpkg.com/animate.css@4.1.1/animate.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=STIX+Two+Text:wght@400..700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@100..900&display=swap">
<link rel="stylesheet" href="https://unpkg.com/@teleporthq/teleport-custom-scripts/dist/style.css">
<link rel="stylesheet" href="{% static 'accounts/style.css' %}">
<link rel="stylesheet" href="{% static 'accounts/index.css' %}">

{% endblock %}

{% block content %}
<div class="registration-container">
  <form method="post">
    {% csrf_token %}
    <div class="frame15432-frame143">
      <span class="frame15432-text10">Ругевіт</span>
    </div>

    <div class="frame15432-getstarted1">
      <span class="frame15432-text11">Зареєструватись</span>

      <div>
        {% for field in form %}
          {% for error in field.errors %}
            <p class="error-message">{{ error }}</p>
          {% endfor %}
        {% endfor %}
        {% for error in form.non_field_errors %}
          <p class="error-message">{{ error }}</p>
        {% endfor %}
      </div>
      
      <div class="frame15432-frame101">
        <span class="frame15432-text19">Нік користувача</span>
        <div class="frame15432-frame244">
          <input type="text" name="username" id="username" class="frame15432-frame241" required placeholder="Введіть нік користувача">
        </div>
      </div>
      
      <div class="frame15432-frame101">
        <span class="frame15432-text19">Email</span>
        <div class="frame15432-frame244">
          {{ form.email }}
        </div>
      </div>
      
      <div class="frame15432-frame139">
        <span class="frame15432-text14">Роль</span>
        <div class="frame15432-frame242 toggle-role">
          <div class="role-option active" data-role="волонтер">Волонтер</div>
          <div class="role-option" data-role="Військовий">Військовий</div>
        </div>
        <input type="hidden" name="role" id="role-input" value="волонтер">
      </div>
      
      <div class="frame15432-frame971">
        <span class="frame15432-text17">Пароль</span>
        <div class="frame15432-frame243">
          {{ form.password1 }}
        </div>
      </div>
      
      <div class="frame15432-frame101">
        <span class="frame15432-text19">Підтвердьте пароль</span>
        <div class="frame15432-frame244">
          {{ form.password2 }}
        </div>
      </div>

      <div class="frame15432-frame981">
        <button type="submit" class="frame15432-add1">
          <span class="frame15432-text22">Створити акаунт</span>
        </button>
        <span class="frame15432-text23">
          <span class="frame15432-text24">Вже маєте акаунт?</span>
          <a href="{% url 'login' %}"><span style="color: #F9A826;">Увійти</span></a>
        </span>
      </div>
    </div>
  </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Role selection
    document.querySelectorAll('.role-option').forEach(option => {
      option.addEventListener('click', function() {
        document.querySelectorAll('.role-option').forEach(el => el.classList.remove('active'));
        this.classList.add('active');
        document.getElementById('role-input').value = this.getAttribute('data-role').toLowerCase();
      });
    });

    // Form validation
    const form = document.querySelector('form');
    if (form) {
      form.addEventListener('submit', function(event) {
        const email = document.querySelector('input[type="email"]').value;
        const password = document.querySelectorAll('input[type="password"]')[0].value;
        const confirmPassword = document.querySelectorAll('input[type="password"]')[1].value;
        const role = document.getElementById('role-input').value;

        if (!email || !password || !confirmPassword || !role || password !== confirmPassword) {
          event.preventDefault();
          if (!email) alert('Будь ласка, введіть email');
          else if (!password) alert('Будь ласка, введіть пароль');
          else if (password !== confirmPassword) alert('Паролі не співпадають');
          else if (!role) alert('Будь ласка, оберіть роль');
          return;
        }
      });
    }
  });
</script>
{% endblock %}
